@model GameLoggd.Models.Domain.UserList

@{
    ViewData["Title"] = Model.Title;
}

<div class="list-hero" style="background: linear-gradient(to bottom, rgba(10,10,10,0.8), var(--bg-dark)), url('/images/hero-bg.jpg'); background-size: cover; padding: 4rem 0 2rem 0; border-bottom: 1px solid var(--border-color); position: relative;">
    <div class="page-container">
        <div style="display: flex; gap: 2rem; align-items: flex-start;">
            <!-- Icon / Cover -->
            <div style="width: 120px; height: 120px; border-radius: 1rem; background: rgba(0, 240, 255, 0.1); border: 1px solid var(--neon-cyan); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                 <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="color: var(--neon-cyan);">
                    <path d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"></path>
                </svg>
            </div>
            
            <div style="flex: 1;">
                <div style="display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                         <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem; text-shadow: 0 0 20px rgba(0,0,0,0.5);">@Model.Title</h1>
                         <div style="display: flex; align-items: center; gap: 1rem; color: var(--text-secondary);">
                             <div style="display: flex; align-items: center; gap: 0.5rem;">
                                 <div class="user-avatar" style="width: 1.5rem; height: 1.5rem; font-size: 0.8rem;">
                                     @Model.User.UserName.ToUpper()[0]
                                 </div>
                                 <a href="/user/@Model.User.UserName" style="color: white; font-weight: 500; hover: underline;">@Model.User.UserName</a>
                             </div>
                             <span>•</span>
                             <span>@Model.Items.Count games</span>
                             <span>•</span>
                             <span>Updated @Model.UpdatedAt.ToString("MMM yyyy")</span>
                         </div>
                    </div>
                    
                    <div style="display: flex; gap: 0.75rem; align-items: center;">
                        <!-- Like Button -->
                         <form action="/list/like" method="post">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="listId" value="@Model.Id" />
                            <button type="submit" class="btn-secondary" style="display: flex; align-items: center; gap: 0.5rem; border-color: @(ViewBag.IsLiked == true ? "#ff304f" : ""); color: @(ViewBag.IsLiked == true ? "#ff304f" : "");">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="@(ViewBag.IsLiked == true ? "currentColor" : "none")" stroke="currentColor" stroke-width="2">
                                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                                </svg>
                                <span>@ViewBag.LikeCount</span>
                            </button>
                        </form>

                        @if (User.Identity.IsAuthenticated && User.Identity.Name == Model.User.UserName)
                        {
                             <a href="/list/@Model.Id/add" class="btn-primary" style="padding: 0.5rem 1.25rem; font-size: 0.9rem;">
                                 <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Add Games
                             </a>
                             <form asp-action="Delete" asp-route-id="@Model.Id" method="post" onsubmit="return confirm('Are you sure you want to delete this list?');">
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn-secondary" style="border-color: #ff4444; color: #ff4444; padding: 0.5rem 1rem;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="3 6 5 6 21 6"></polyline>
                                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    </svg>
                                </button>
                            </form>
                        }
                    </div>
                </div>
                
                @if (!string.IsNullOrEmpty(Model.Description))
                {
                    <p style="color: #ccc; max-width: 800px; line-height: 1.6; font-size: 1.1rem;">@Model.Description</p>
                }
            </div>
        </div>
    </div>
</div>

<div class="page-container" style="padding: 2rem 1.5rem;">
    @if (Model.Items.Any())
    {
        @await Html.PartialAsync("_GameGrid", Model.Items.Select(i => i.Game).ToList())
    }
    else
    {
        <div style="text-align: center; padding: 6rem; color: var(--text-secondary); background: var(--bg-card); border-radius: 1rem; border: 1px dashed var(--border-color);">
            <p style="margin-bottom: 1rem; font-size: 1.1rem;">This list is currently empty.</p>
            @if (User.Identity.IsAuthenticated && User.Identity.Name == Model.User.UserName)
            {
                <a href="/list/@Model.Id/add" style="color: var(--neon-cyan); font-weight: 500;">Search for games to add →</a>
            }
        </div>
    }
</div>
